#### 概述
暴力破解是一种通过系统化地尝试所有可能的密码或密钥组合，直到找到正确组合为止的攻击方法。常用于破解用户账户密码、服务认证等。

#### 注意事项与准备
1.  **有效字典**：破解前必须准备一个相关的、有效的密码字典。
2.  **目标分析**：
    *   **密码策略**：判断目标是否强制要求复杂密码（长度、字符类型组合）。
    *   **验证码**：是否存在验证码机制。
    *   **登录限制**：尝试登录的次数是否受限（如错误次数过多导致账户或IP锁定）。
    *   **双因素认证 (2FA)**：是否启用了如手机短信、动态令牌等二次验证。
    *   **Token**：登录过程是否使用动态Token重复提交或CSRF。
    *   **默认密码**：检查是否存在未修改的系统默认密码（尤其在内部服务或新部署系统）。
    *   **账户存在性**：确认要破解的账号是真实存在的。测试正确/错误账号的返回信息差异。可通过注册、找回密码、企业邮箱命名规则等方式推断。
3.  **流程熟悉**：对目标网站/应用的注册、登录、修改密码、找回密码等流程进行测试，了解其限制和可能存在的逻辑漏洞（如新旧密码允许相同）。
4.  **常见目标账户**：破解管理后台时，优先尝试 `admin`, `administrator`, `root` 等常见用户名。

#### C/S与B/S架构区别
*   **C/S (Client/Server)**：客户端/服务器模式。
    *   **硬件环境**：通常基于专用网络或小范围网络。
    *   **安全要求**：相对较高，用户群固定，信息保护较强。
    *   **系统维护**：客户端更新部署相对困难。
*   **B/S (Browser/Server)**：浏览器/服务器模式。
    *   **硬件环境**：基于广域网（互联网），适应性强，有操作系统和浏览器即可。
    *   **安全要求**：相对较低，面向用户范围广。
    *   **系统维护**：维护升级集中在服务器端，较为简单。

#### 暴力破解分类
1.  **基于表单的暴力破解**：针对Web登录表单进行用户名和密码的尝试。通过在注册页面使用可能的用户名进行注册，可以获取到存在的用户名。
2.  **基于验证码的暴力破解**：尝试绕过或识别验证码进行破解。
    *   **客户端(on client)问题**：
        *   不安全的JS实现验证码生成与校验（可被绕过或禁用JS）。
        *   验证码内容泄露在Cookie或前端源码中。
    *   **服务端(on server)问题**：
        *   验证码不过期，可被重复使用（如PHP Session默认24分钟过期）。
        *   验证码校验逻辑不严谨或存在漏洞。
        *   验证码设计过于简单或有规律，易被机器识别或猜解。
3.  **基于Token的破解**：
    *   如果防暴力破解的Token值输出在前端源码中，容易被攻击者获取并用于后续请求，失去防护意义。
    *   常用于配合工具（如Burp Suite的Pitchfork模式+Grep-Extract）进行自动化攻击。
4.  **基于系统、数据库、中间件等第三方服务破解 (C/S架构常见)**：
    *   针对SSH, FTP, RDP, MySQL, SQL Server等服务的认证进行破解。
    *   可使用漏洞扫描器自带模块、Hydra、Bruter等工具。

#### 验证码安全
*   **原理**：服务器生成随机验证码与SessionID关联，返回给客户端显示，用户提交时服务器验证输入与Session中存储的是否一致，验证后销毁会话或使其过期。
*   **常见问题**：
    *   **客户端生成/验证**：极不安全，易绕过。
    *   **验证码内容输出到客户端**：如在Cookie或Header中包含验证码原文、MD5值、Base64编码等，易被逆向。
    *   **依赖Cookie/Session判断错误次数**：攻击者可通过不带Cookie或不更新错误标记的Cookie来绕过验证码的触发机制。
    *   **验证码不过期/复用**：验证码使用一次后未立即销毁，导致可被重复利用。
    *   **未进行非空判断**：提交空验证码可能绕过检查。
    *   **答案空间有限**：如选择题型验证码选项过少，易被暴力枚举。
    *   **验证码过于简单**：易被OCR工具（如pkav的识别功能）识别。

#### 暴力破解工具与方法

##### C/S架构工具
*   **[[Hydra]]**：
    *   **概述**：Hydra 是一款流行的、开源的、并行的网络登录破解器（通常被称为暴力破解工具）。它支持多种协议，旨在帮助安全研究人员和顾问发现网络服务上的弱密码或默认凭证。它是许多以安全为重点的 Linux 发行版（如 Kali Linux）中包含的标准工具。
*   **Bruter**：
    *   **概述**：Windows下的图形化破解工具，支持多种协议。
    *   **使用步骤**：
        1.  添加目标地址、选择协议、端口。
        2.  添加用户名（单个、列表或生成）。
        3.  选择密码字典或使用字符组合功能。
        4.  开始破解。
    *   **注意**：可能不支持中文目录。
*   **[[John]]**：
    *   **概述**：John the Ripper（简称 John）是一款著名且功能强大的开源密码破解工具。它旨在检测弱密码，支持破解数十种哈希类型（如 Linux shadow 文件、LM 哈希、MD5、SHA-1、Kerberos TGT 等），并能识别受密码保护的文件（如 ZIP、RAR、SSH 密钥）。它提供了多种攻击模式，适用于各种密码破解场景。

##### B/S架构工具 (Burp Suite)
*   **概述**：常使用Burp Suite的Intruder模块进行Web应用的暴力破解。需理解其攻击类型 (Sniper, Battering Ram, Pitchfork, Cluster Bomb)。
*   **场景：基于表单**
    1.  浏览器设置代理，正常提交一次登录请求（任意密码）。
    2.  在Burp Proxy的HTTP History中找到该请求，右键发送到Intruder。
    3.  在Intruder > Positions标签页，点击`Clear §`清除默认标记，然后选中密码字段的值，点击`Add §`标记为Payload位置。如果用户名也需要爆破，则标记用户名并选择合适的攻击类型（如Cluster Bomb）。
    4.  转到Payloads标签页，Payload type选择`Simple list`，在Payload Options中加载密码字典。
    5.  点击`Start attack`开始爆破，观察响应的状态码、长度或内容判断是否成功。
*   **场景：基于验证码**
    *   **客户端验证**：首次使用正确验证码抓包，在Intruder中移除验证码参数或保持不变（如果验证逻辑在前端JS），然后爆破密码。
    *   **服务端验证**：
        *   **验证码复用**：如果验证码不过期，抓取一个有效验证码和对应的Session，然后在Intruder中固定验证码和Session值，爆破密码。
        *   **简单验证码识别**：结合pkav等工具（见下文）或专用验证码识别接口/服务。
*   **场景：基于Token**
    1.  抓取登录请求，发送到Intruder。
    2.  标记密码和Token值为Payload位置。选择`Pitchfork`攻击类型。
    3.  设置Payloads：
        *   Payload set 1 (密码): 加载密码字典。
        *   Payload set 2 (Token): Payload type选择`Recursive grep`。
    4.  在Options > Grep - Extract，添加规则，提取响应中新的Token值。点击`Refetch response`测试提取是否正确。
    5.  在Payload set 2的Payload Processing中，添加规则以匹配或处理提取到的Token格式（如果需要）。
    6.  在Options > Request Engine，将线程数设为`1`，以保证Token按顺序获取和使用。
    7.  开始攻击。
*   **场景：简单验证码爆破 (pkav)**
    1.  抓取包含验证码的登录请求包。
    2.  将请求数据和目标URL填入pkav攻击器。
    3.  标记密码和验证码字段为变量。
    4.  添加密码字典。
    5.  在pkav的【验证码识别】模块：
        *   粘贴验证码图片的URL。
        *   框选验证码识别区域。
        *   测试识别效果。
    6.  在【返回数据处理】或相关设置中，输入验证码错误时的响应关键字（用于判断识别是否成功或爆破是否命中）。
    7.  开始攻击。
* **[[Web Fuzzing]]**:
	* **概述**: Web Fuzzing 是一种通过向 Web 应用程序发送大量、自动生成的请求来探测隐藏内容、目录、参数或有效凭证（如用户名、密码）的技术。`ffuf` 是一款常用的高速 Web Fuzzing 工具。

#### 安全防范
1.  **强制验证码/OTP**：登录、重要操作强制使用验证码或手机OTP（一次性密码）。
2.  **IP策略**：限制单一IP的尝试频率和总次数。注意`X-Forwarded-For`等HTTP头可能被用于绕过IP限制。
3.  **验证码安全**：
    *   **一次性**：验证码使用一次后立即失效。
    *   **复杂度**：使用扭曲、干扰线、噪点、不同字体、背景色等增加机器识别难度。
    *   **统一接口**：大型网站建议使用统一的安全验证码服务接口。
4.  **复杂密码策略**：强制用户设置符合长度和复杂度要求的密码。
5.  **登录限制**：实施尝试次数限制，如连续N次失败后锁定账户或IP一段时间。
6.  **双因素认证 (2FA)**：对高权限账户或敏感操作启用2FA。


[[密码哈希算法]]