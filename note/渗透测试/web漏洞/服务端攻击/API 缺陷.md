#### 概述：什么是 API？ (Overview: What is an API?)

**API (Application Programming Interface)**，即应用程序编程接口，是一种中间件，它通过一套预定义的协议和规则，允许两个不同的软件组件相互通信和交换数据。在 API 的上下文中，“接口”可以被看作是两个应用程序之间的服务合同，通过**请求 (Request)** 和**响应 (Response)** 来实现通信。API 是构建现代复杂应用程序的基石。

#### OWASP API Security Top 10

以下是开放 Web 应用程序安全项目 (OWASP) 总结的最关键的 10 大 API 安全风险。

##### 1. 访问控制缺陷：对象级别授权失效 (BOLA - Broken Object Level Authorization)

###### 描述 (Description)

也称为**不安全的直接对象引用 (IDOR)**。此漏洞发生在 API 端点未能正确验证当前用户是否有权访问其请求的特定对象（如数据记录、文件）时。攻击者可以通过修改请求中的对象 ID（例如，从 `/api/users/123` 修改为 `/api/users/456`）来访问其他用户的数据。

###### 可能的影响 (Potential Impact)

未经授权的数据泄露，严重时甚至可能导致账户完全被接管，对组织声誉和财务造成巨大损失。

##### 2. 认证失效 (Broken User Authentication)

###### 描述 (Description)

当用户认证机制（如登录、密码重置、API 密钥、令牌）的实现存在缺陷时，就会发生此漏洞。这可能包括对弱密码没有限制、令牌泄露、令牌验证不当等。

###### 可能的影响 (Potential Impact)

攻击者可以破坏认证会话，冒充合法用户，执行未授权的操作，甚至完全接管账户。

##### 3. 过度数据暴露 (Excessive Data Exposure)

###### 描述 (Description)

当 API 响应中包含了超出客户端实际需要的多余数据，特别是敏感数据时，就会发生此漏洞。开发者常常为了方便而返回整个数据对象，寄希望于前端来过滤显示，但这使得攻击者可以直接通过拦截 API 响应来获取敏感信息（如密码哈希、个人身份信息、内部令牌等）。

###### 可能的影响 (Potential Impact)

攻击者可以轻松获取机密数据，包括个人信息、账户号码、访问令牌等，这些信息可被用于进一步的攻击。

##### 4. 资源不足与速率限制缺失 (Lack of Resources & Rate Limiting)

###### 描述 (Description)

当 API 未对客户端请求资源的频率（速率限制）或大小（如文件上传大小）施加任何限制时，就会发生此漏洞。这使得攻击者可以通过发送大量请求或上传巨大文件来耗尽服务器资源（CPU、内存、存储、网络带宽），导致拒绝服务 (DoS)。

###### 可能的影响 (Potential Impact)

主要影响系统的**可用性**，导致服务对正常用户不可用，损害品牌声誉并可能造成经济损失。

##### 5. 功能级别授权失效 (Broken Function Level Authorization)

###### 描述 (Description)

此漏洞发生在 API 未能正确验证用户是否有权执行其请求的特定功能时。这与 BOLA（对象级别）不同，它关注的是**操作权限**。例如，一个普通用户通过直接调用一个未受保护的管理员 API 端点（如 `/api/admin/deleteUser`）来执行只有管理员才能执行的操作。

###### 可能的影响 (Potential Impact)

攻击者可以冒充授权用户，执行敏感的管理任务，如删除用户、修改权限等，对系统的授权和不可否认性构成严重威胁。

##### 6. 批量赋值 (Mass Assignment)

###### 描述 (Description)

当 API 自动将客户端发送的数据绑定到服务器端的对象或变量上时，可能会发生此漏洞。如果 API 不对传入的数据字段进行严格的白名单验证，攻击者就可以在请求中添加或修改他们本不应有权修改的字段（例如，在个人资料更新请求中添加 `"isAdmin": true"`）。

###### 可能的影响 (Potential Impact)

导致数据篡改，以及未经授权的权限提升（例如，普通用户将自己提升为管理员）。

##### 7. 安全配置错误 (Security Misconfiguration)

###### 描述 (Description)

这是最常见的漏洞之一，涵盖了各种不当的安全配置。例如，使用不完整的默认配置、公开可访问的云存储桶、过于宽松的跨源资源共享 (CORS) 策略、在错误消息中泄露详细的堆栈跟踪信息，或 Web 应用防火墙 (WAF) 配置不当等。

###### 可能的影响 (Potential Impact)

使攻击者能够进行详细的侦察，绕过安全机制，并获取访问机密数据和关键系统细节的机会，为进一步的攻击铺平道路。

##### 8. 注入 (Injection)

###### 描述 (Description)

当来自客户端的不可信数据未经正确验证或清理，就被作为命令或查询的一部分发送到后端解释器时，就会发生注入攻击。最常见的例子包括 SQL 注入、操作系统命令注入和 XML 注入。

###### 可能的影响 (Potential Impact)

可能导致信息泄露、数据丢失、拒绝服务，甚至完全的服务器接管和远程代码执行。

##### 9. 资产管理不当 (Improper Assets Management)

###### 描述 (Description)

当组织未能正确跟踪和管理其所有的 API 端点时，就会发生此漏洞。例如，一个旧版本的 API (`/api/v1`) 在新版本 (`/api/v2`) 上线后没有被正确停用，而这个旧版本可能缺少新版本的安全补丁，从而成为一个被遗忘的攻击面。

###### 可能的影响 (Potential Impact)

攻击者可以利用未打补丁的、被遗忘的旧版 API 来未经授权地访问机密数据，甚至完全控制系统。

##### 10. 日志与监控不足 (Insufficient Logging & Monitoring)

###### 描述 (Description)

当系统缺乏足够的日志记录、监控和告警机制时，攻击者可以在不被发现的情况下长时间地进行恶意活动。许多组织只关注基础设施层面的日志，而忽略了 API 层面（如谁访问了哪个端点、输入了什么数据）的详细日志。

###### 可能的影响 (Potential Impact)

使组织无法及时发现正在进行的攻击，并在事后难以进行有效的应急响应和取证分析，无法识别攻击者及其攻击路径。